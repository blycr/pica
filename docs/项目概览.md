# 项目概览

## 项目名称与状态
**项目名称**: Pica Manga ⚠️ **评分系统**: 已实现基础接口，但部分统计逻辑仍需完善开发中 (Alpha)  
**目标**: 构建一个高颜值、现代化的局域网漫画预览与管理系统。
> ⚠️ **注意**: 目前虽然基础架构已搭建，但移动端适配、主页功能及性能在高负载下仍存在重大缺陷，详见 [待办事项](./待办事项.md)。

## 核心技术栈

### 前端
- **构建工具**: Vite
- **样式框架**: Tailwind CSS (v4)
- **脚本语言**: JavaScript (Vanilla)
- **包管理**: pnpm

### 后端
- **运行时**: Node.js
- **框架**: Express
- **数据库**: SQLite (better-sqlite3)
- **工具库**: cors, multer, nodemon, sharp

### 🛣️ 路线图 (Roadmap)

我们正在积极开发以下功能：

- **P0 移动端重构**: 彻底修复移动端体验，实现原生级手势交互。
- **P1 系统配置**: 提供可视化的设置界面，支持自定义端口、书库路径等核心参数。
- **P2 用户系统**: 引入账户体系，保障数据安全与个性化记录。
- **P3 体验优化**: 引入黑夜模式、PWA 支持及更多源的元数据匹配。

## 关键文件路径映射

### 前端
- `index.html`: 项目入口
- `src/main.js`: 逻辑入口与路由分发
- `src/main.css`: 全局样式与设计系统
- `src/api/`: API 请求模块
- `src/components/`: 可复用 UI 组件
- `src/pages/`: 页面模块 (Library, Reader, etc.)
- `src/utils/`: 路由与 DOM 工具

### 后端
- `server/index.js`: 服务器入口
- `server/db/init.js`: 数据库初始化
- `server/routes/`: API 路由目录
- `server/utils/`: 工具函数（扫描器、缩略图）

### 文档
- `docs/`: 项目文档目录
- `README.md`: 项目说明

## 高频常用命令
- `pnpm start`: 同时启动前端和后端
- `pnpm dev`: 启动前端开发服务器 (http://localhost:5173)
- `pnpm server:dev`: 启动后端开发服务器 (http://localhost:3000)
- `pnpm test`: 运行测试
- `pnpm build`: 构建生产版本

## 核心业务逻辑规则

### 文件扫描
- 漫画文件以文件夹形式存储（封面 + 章节/页面）
- 支持两种目录结构：章节目录模式、单卷模式
- 系统需支持多种字符编码（中、日、韩、Emoji）
- 自动提取封面、章节信息

### 数据存储
- 使用 SQLite 存储漫画元数据
- 支持标签系统，用户可为漫画打标签
- 记录阅读历史和进度
- 支持收藏功能
- 支持多书库管理

### UI/UX
- 优先采用玻璃拟态 (Glassmorphism) 和深色模式设计
- 响应式布局，适配桌面、平板、手机
- 流畅的动画和交互效果

## 当前进展

### 已完成 (基础架构) ✅
- [x] 项目初始化和依赖安装 (pnpm + Vite)
- [x] Tailwind CSS v4 配置和 Premium Glassmorphism 设计系统
- [x] Express 后端服务器搭建与 SQLite 数据库架构设计
- [x] 文件扫描器逻辑实现（支持多种目录结构）
- [x] 局域网图片服务支持 (`/api/image` 接口)
- [x] 缩略图生成系统（支持三种尺寸、WebP格式、智能缓存）
- [x] 前端 SPA 路由分发基础架构

### 🚧 规划中 / 待修复 (Roadmap & Hotfixes)
- [ ] **P0: 移动端全面重构** (现状无法正常使用)
- [ ] **P0: 主题切换逻辑** (现状锁定黑夜模式)
- [ ] **P0: 主页收藏/历史数据真实对接**
- [ ] **P0: 列表虚拟滚动性能优化** (防止千本漫画卡死)
- [ ] **P1: 可视化设置页面** (配置回写功能)
- [ ] **P1: 用户系统与权限** (JWT)
- [ ] **P1: 完整阅读进度同步**


### 待办事项 📋
- [ ] 元数据外部API集成（MyAnimeList, AniList, Bangumi）
- [ ] 自动化部署脚本

## 下一步计划
详见 [待办事项](./待办事项.md)。

## 架构与API
详见 [技术与架构](./技术与架构.md) 和 [API 文档](./API文档.md)。
