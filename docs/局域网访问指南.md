# å±€åŸŸç½‘è®¿é—®æŒ‡å—

## ğŸ“… æ›´æ–°æ—¶é—´
2026-01-14

---

## ğŸŒ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨å±€åŸŸç½‘å†…è®¿é—® Pica Manga ç³»ç»Ÿï¼Œè®©åŒä¸€ç½‘ç»œä¸‹çš„å…¶ä»–è®¾å¤‡ï¼ˆæ‰‹æœºã€å¹³æ¿ã€å…¶ä»–ç”µè„‘ï¼‰éƒ½èƒ½è®¿é—®æ‚¨çš„æ¼«ç”»åº“ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è·å–æœ¬æœºIPåœ°å€

#### Windows ç³»ç»Ÿ
```powershell
# æ–¹æ³•1: ä½¿ç”¨ ipconfig
ipconfig

# æŸ¥æ‰¾ "IPv4 åœ°å€" æˆ– "IPv4 Address"
# é€šå¸¸æ ¼å¼ä¸º: 192.168.x.x æˆ– 10.0.x.x
```

#### macOS/Linux ç³»ç»Ÿ
```bash
# æ–¹æ³•1: ä½¿ç”¨ ifconfig
ifconfig

# æ–¹æ³•2: ä½¿ç”¨ ip (Linux)
ip addr show

# æŸ¥æ‰¾ inet å­—æ®µï¼Œé€šå¸¸æ ¼å¼ä¸º: 192.168.x.x
```

**ç¤ºä¾‹è¾“å‡º**:
```
æ— çº¿å±€åŸŸç½‘é€‚é…å™¨ WLAN:
   IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.1.100
```

è®°ä½è¿™ä¸ªIPåœ°å€ï¼Œä¾‹å¦‚ `192.168.1.100`

---

### 2. é…ç½®æœåŠ¡å™¨ç›‘å¬åœ°å€

é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨åªç›‘å¬ `localhost`ï¼Œéœ€è¦ä¿®æ”¹ä¸ºç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ã€‚

#### æ–¹æ³•1: ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰

åˆ›å»ºæˆ–ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```bash
# .env
HOST=0.0.0.0
PORT=3000
```

#### æ–¹æ³•2: ä¿®æ”¹å¯åŠ¨è„šæœ¬

ç¼–è¾‘ `package.json`ï¼š
```json
{
  "scripts": {
    "server:dev": "HOST=0.0.0.0 nodemon server/index.js"
  }
}
```

æˆ–è€…ç›´æ¥ä¿®æ”¹ `server/index.js`ï¼š
```javascript
const HOST = process.env.HOST || '0.0.0.0';
const PORT = process.env.PORT || 3000;

app.listen(PORT, HOST, () => {
    console.log(`ğŸš€ Server running on http://${HOST}:${PORT}`);
});
```

---

### 3. é…ç½®é˜²ç«å¢™

#### Windows é˜²ç«å¢™

**æ–¹æ³•1: å›¾å½¢ç•Œé¢**
1. æ‰“å¼€ "Windows Defender é˜²ç«å¢™"
2. ç‚¹å‡» "é«˜çº§è®¾ç½®"
3. é€‰æ‹© "å…¥ç«™è§„åˆ™" â†’ "æ–°å»ºè§„åˆ™"
4. é€‰æ‹© "ç«¯å£" â†’ ä¸‹ä¸€æ­¥
5. é€‰æ‹© "TCP"ï¼Œè¾“å…¥ç«¯å£å· `3000` â†’ ä¸‹ä¸€æ­¥
6. é€‰æ‹© "å…è®¸è¿æ¥" â†’ ä¸‹ä¸€æ­¥
7. å‹¾é€‰æ‰€æœ‰ç½‘ç»œç±»å‹ â†’ ä¸‹ä¸€æ­¥
8. è¾“å…¥åç§° "Pica Manga Server" â†’ å®Œæˆ

**æ–¹æ³•2: PowerShell å‘½ä»¤**
```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell
New-NetFirewallRule -DisplayName "Pica Manga Server" -Direction Inbound -Protocol TCP -LocalPort 3000 -Action Allow
```

#### macOS é˜²ç«å¢™

macOS é»˜è®¤é˜²ç«å¢™é€šå¸¸å…è®¸å…¥ç«™è¿æ¥ï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ‰“å¼€ "ç³»ç»Ÿåå¥½è®¾ç½®" â†’ "å®‰å…¨æ€§ä¸éšç§" â†’ "é˜²ç«å¢™"
2. ç‚¹å‡» "é˜²ç«å¢™é€‰é¡¹"
3. æ·»åŠ  Node.js æˆ–å…è®¸æ‰€æœ‰ä¼ å…¥è¿æ¥

#### Linux é˜²ç«å¢™ (UFW)

```bash
# å…è®¸ 3000 ç«¯å£
sudo ufw allow 3000/tcp

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status
```

---

### 4. å¯åŠ¨æœåŠ¡å™¨

```bash
# å¯åŠ¨å‰ç«¯å’Œåç«¯
pnpm start

# æˆ–åˆ†åˆ«å¯åŠ¨
pnpm dev        # å‰ç«¯ (ç«¯å£ 5173)
pnpm server:dev # åç«¯ (ç«¯å£ 3000)
```

---

### 5. è®¿é—®æœåŠ¡

#### åœ¨æœ¬æœºè®¿é—®
- å‰ç«¯: `http://localhost:5173`
- åç«¯: `http://localhost:3000`

#### åœ¨å±€åŸŸç½‘å…¶ä»–è®¾å¤‡è®¿é—®
å°† `localhost` æ›¿æ¢ä¸ºæ‚¨çš„IPåœ°å€ï¼š
- å‰ç«¯: `http://192.168.1.100:5173`
- åç«¯: `http://192.168.1.100:3000`

**æ³¨æ„**: å‰ç«¯ä¹Ÿéœ€è¦é…ç½®å…è®¸å±€åŸŸç½‘è®¿é—®ï¼Œç¼–è¾‘ `vite.config.js`:
```javascript
export default {
  server: {
    host: '0.0.0.0',
    port: 5173
  }
}
```

---

## ğŸ”§ é«˜çº§é…ç½®

### 1. è®¾ç½®é™æ€IPåœ°å€

ä¸ºäº†é¿å…æ¯æ¬¡é‡å¯åIPåœ°å€å˜åŒ–ï¼Œå»ºè®®è®¾ç½®é™æ€IPã€‚

#### Windows é™æ€IPè®¾ç½®
1. æ‰“å¼€ "æ§åˆ¶é¢æ¿" â†’ "ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒ"
2. ç‚¹å‡»å½“å‰ç½‘ç»œè¿æ¥ â†’ "å±æ€§"
3. é€‰æ‹© "Internet åè®®ç‰ˆæœ¬ 4 (TCP/IPv4)" â†’ "å±æ€§"
4. é€‰æ‹© "ä½¿ç”¨ä¸‹é¢çš„IPåœ°å€"
5. è¾“å…¥ï¼š
   - IPåœ°å€: `192.168.1.100` (æ ¹æ®æ‚¨çš„ç½‘ç»œè°ƒæ•´)
   - å­ç½‘æ©ç : `255.255.255.0`
   - é»˜è®¤ç½‘å…³: `192.168.1.1` (é€šå¸¸æ˜¯è·¯ç”±å™¨åœ°å€)
   - é¦–é€‰DNS: `8.8.8.8` (Google DNS)

#### macOS é™æ€IPè®¾ç½®
1. æ‰“å¼€ "ç³»ç»Ÿåå¥½è®¾ç½®" â†’ "ç½‘ç»œ"
2. é€‰æ‹©å½“å‰ç½‘ç»œ â†’ "é«˜çº§"
3. é€‰æ‹© "TCP/IP" æ ‡ç­¾
4. é…ç½®IPv4: é€‰æ‹© "æ‰‹åŠ¨"
5. è¾“å…¥IPåœ°å€ã€å­ç½‘æ©ç ã€è·¯ç”±å™¨åœ°å€

---

### 2. ä½¿ç”¨åŸŸåè®¿é—®ï¼ˆå¯é€‰ï¼‰

#### æ–¹æ³•1: ä¿®æ”¹hostsæ–‡ä»¶

åœ¨å±€åŸŸç½‘å†…çš„æ¯å°è®¾å¤‡ä¸Šä¿®æ”¹ hosts æ–‡ä»¶ï¼š

**Windows**: `C:\Windows\System32\drivers\etc\hosts`
**macOS/Linux**: `/etc/hosts`

æ·»åŠ ä¸€è¡Œï¼š
```
192.168.1.100  pica.local
```

ç„¶åå¯ä»¥é€šè¿‡ `http://pica.local:5173` è®¿é—®ã€‚

#### æ–¹æ³•2: é…ç½®è·¯ç”±å™¨DNS

åœ¨è·¯ç”±å™¨ç®¡ç†ç•Œé¢é…ç½®æœ¬åœ°DNSè§£æï¼ˆéœ€è¦è·¯ç”±å™¨æ”¯æŒï¼‰ã€‚

---

### 3. åå‘ä»£ç†é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

ä½¿ç”¨ Nginx ä½œä¸ºåå‘ä»£ç†ï¼Œç»Ÿä¸€å‰åç«¯è®¿é—®ç«¯å£ã€‚

#### å®‰è£… Nginx

**Windows**: ä¸‹è½½ [nginx.org](http://nginx.org/en/download.html)
**macOS**: `brew install nginx`
**Linux**: `sudo apt install nginx`

#### é…ç½®æ–‡ä»¶ç¤ºä¾‹

ç¼–è¾‘ `nginx.conf`:
```nginx
server {
    listen 80;
    server_name 192.168.1.100;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        proxy_pass http://localhost:5173;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # åç«¯API
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

å¯åŠ¨ Nginx åï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ `http://192.168.1.100` è®¿é—®ï¼ˆ80ç«¯å£ï¼‰ã€‚

---

## ğŸ“± ç§»åŠ¨ç«¯è®¿é—®ä¼˜åŒ–

### 1. æ·»åŠ åˆ°ä¸»å±å¹•

åœ¨ç§»åŠ¨æµè§ˆå™¨ä¸­è®¿é—®åï¼Œå¯ä»¥"æ·»åŠ åˆ°ä¸»å±å¹•"ï¼Œè·å¾—ç±»ä¼¼åŸç”Ÿåº”ç”¨çš„ä½“éªŒã€‚

### 2. PWA æ”¯æŒï¼ˆå¯é€‰ï¼‰

å¯ä»¥æ·»åŠ  Service Worker å’Œ manifest.json å®ç°ç¦»çº¿è®¿é—®ã€‚

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. ä»…åœ¨å—ä¿¡ä»»çš„ç½‘ç»œä½¿ç”¨

å±€åŸŸç½‘è®¿é—®æ„å‘³ç€åŒä¸€ç½‘ç»œä¸‹çš„æ‰€æœ‰è®¾å¤‡éƒ½èƒ½è®¿é—®ï¼Œè¯·ç¡®ä¿ï¼š
- ä»…åœ¨å®¶åº­æˆ–åŠå…¬å®¤ç­‰å—ä¿¡ä»»çš„ç½‘ç»œä½¿ç”¨
- ä¸è¦åœ¨å…¬å…±WiFiä¸‹å¼€æ”¾è®¿é—®

### 2. æ·»åŠ è®¤è¯ï¼ˆæ¨èï¼‰

å¯ä»¥æ·»åŠ ç®€å•çš„å¯†ç ä¿æŠ¤ï¼š

```javascript
// server/middleware/auth.js
export function basicAuth(req, res, next) {
    const authHeader = req.headers.authorization;
    
    if (!authHeader || authHeader !== 'Bearer your-secret-token') {
        return res.status(401).json({ error: 'Unauthorized' });
    }
    
    next();
}

// åœ¨ server/index.js ä¸­ä½¿ç”¨
import { basicAuth } from './middleware/auth.js';
app.use('/api', basicAuth);
```

### 3. ä½¿ç”¨HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

å¯ä»¥ä½¿ç”¨è‡ªç­¾åè¯ä¹¦æˆ– Let's Encrypt è¯ä¹¦å¯ç”¨HTTPSã€‚

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ— æ³•è®¿é—®æœåŠ¡å™¨

**æ£€æŸ¥æ¸…å•**:
1. âœ… æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Ÿ
2. âœ… IPåœ°å€æ˜¯å¦æ­£ç¡®ï¼Ÿ
3. âœ… é˜²ç«å¢™æ˜¯å¦å·²é…ç½®ï¼Ÿ
4. âœ… è®¾å¤‡æ˜¯å¦åœ¨åŒä¸€å±€åŸŸç½‘ï¼Ÿ
5. âœ… ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Ÿ

**æµ‹è¯•è¿æ¥**:
```bash
# åœ¨å…¶ä»–è®¾å¤‡ä¸Šæµ‹è¯•
ping 192.168.1.100

# æµ‹è¯•ç«¯å£æ˜¯å¦å¼€æ”¾
telnet 192.168.1.100 3000
```

### Q2: å¯ä»¥è®¿é—®åç«¯ï¼Œä½†å‰ç«¯æ— æ³•åŠ è½½

æ£€æŸ¥å‰ç«¯çš„ API è¯·æ±‚åœ°å€é…ç½®ï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„IPåœ°å€è€Œä¸æ˜¯ localhostã€‚

ç¼–è¾‘ `src/api/config.js`:
```javascript
const API_BASE_URL = import.meta.env.PROD 
    ? '/api'  // ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç›¸å¯¹è·¯å¾„
    : 'http://192.168.1.100:3000/api';  // å¼€å‘ç¯å¢ƒä½¿ç”¨IPåœ°å€
```

### Q3: ç§»åŠ¨ç«¯è®¿é—®é€Ÿåº¦æ…¢

å¯èƒ½åŸå› ï¼š
1. å›¾ç‰‡æ–‡ä»¶è¿‡å¤§ â†’ ä½¿ç”¨ç¼©ç•¥å›¾åŠŸèƒ½
2. ç½‘ç»œä¿¡å·å¼± â†’ æ£€æŸ¥WiFiä¿¡å·
3. æœåŠ¡å™¨æ€§èƒ½ä¸è¶³ â†’ ä¼˜åŒ–ä»£ç æˆ–å‡çº§ç¡¬ä»¶

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¯ç”¨ç¼“å­˜

åœ¨ Nginx é…ç½®ä¸­æ·»åŠ ç¼“å­˜ï¼š
```nginx
location ~* \.(jpg|jpeg|png|gif|webp)$ {
    expires 30d;
    add_header Cache-Control "public, immutable";
}
```

### 2. å¯ç”¨ Gzip å‹ç¼©

```nginx
gzip on;
gzip_types text/plain text/css application/json application/javascript;
```

### 3. ä½¿ç”¨ç¼©ç•¥å›¾

ç¡®ä¿ä½¿ç”¨ç¼©ç•¥å›¾APIè€Œä¸æ˜¯åŸå›¾ï¼š
```javascript
// ä½¿ç”¨ç¼©ç•¥å›¾
const thumbnailUrl = `/api/thumbnails/generate?path=${coverPath}&size=medium`;

// è€Œä¸æ˜¯åŸå›¾
const originalUrl = `/api/image?path=${coverPath}`;
```

---

## ğŸ‰ æ€»ç»“

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿï¼š
- âœ… åœ¨å±€åŸŸç½‘å†…ä»»ä½•è®¾å¤‡è®¿é—® Pica Manga
- âœ… ä½¿ç”¨æ‰‹æœºã€å¹³æ¿æµè§ˆæ¼«ç”»
- âœ… äº«å—æµç•…çš„é˜…è¯»ä½“éªŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥é˜²ç«å¢™è®¾ç½®å’Œç½‘ç»œè¿æ¥ã€‚

---

**æœ€åæ›´æ–°**: 2026-01-14  
**é€‚ç”¨ç‰ˆæœ¬**: v0.3.0+
