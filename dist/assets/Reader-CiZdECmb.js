import{c as t,r as c,I as N,a as $}from"./index-HWS5ZIqz.js";async function k(m){const{mangaId:n,chapterId:i}=m,o=t("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col h-screen w-screen focus:outline-none",tabIndex:0}),v=t("div",{className:"h-16 bg-gradient-to-b from-black/80 to-transparent absolute top-0 w-full z-20 flex items-center px-6 justify-between opacity-0 hover:opacity-100 transition-opacity duration-300"},[t("button",{className:"text-white/80 hover:text-white flex items-center gap-2",onclick:()=>c.navigate(`/manga/${n}`)},[t("div",{innerHTML:N.ChevronRight,className:"transform rotate-180 w-6 h-6"}),t("span",{className:"font-bold"},["Back"])]),t("span",{className:"text-gray-400 text-sm"},["Reader Mode"])]);o.appendChild(v);const s=t("div",{className:"flex-1 overflow-y-auto w-full h-full bg-gray-900 scroll-smooth custom-scrollbar flex flex-col items-center py-10 gap-2"}),C=t("div",{className:"text-white/50 animate-pulse mt-20"},["Loading pages..."]);s.appendChild(C),o.appendChild(s);try{const h=(await $.manga.get(n)).chapters||[],p=h.findIndex(e=>e.id==i),g=p>0?h[p-1]:null,l=p<h.length-1?h[p+1]:null,w=await b(n,i);if(s.innerHTML="",w.pages.length===0)s.appendChild(t("div",{className:"text-white text-xl mt-20"},["No pages found in this chapter."]));else{w.pages.forEach(a=>{const r=`http://localhost:3000/api/image?path=${encodeURIComponent(a.path)}`,x=t("div",{className:"w-full max-w-4xl flex justify-center"},[t("img",{src:r,className:"max-w-full h-auto shadow-2xl bg-gray-800 min-h-[500px] object-contain",loading:"lazy",alt:`Page ${a.page}`})]);s.appendChild(x)});const e=t("div",{className:"w-full max-w-4xl flex justify-between px-4 py-8 gap-4 mt-8"});g?e.appendChild(t("button",{className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-lg flex items-center gap-2 transition-colors border border-white/10",onclick:()=>c.navigate(`/read/${n}/${g.id}`)},["← Previous Chapter"])):e.appendChild(t("div")),l&&(e.appendChild(t("button",{className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-lg flex items-center gap-2 transition-colors shadow-lg shadow-blue-500/20",onclick:()=>c.navigate(`/read/${n}/${l.id}`)},["Next Chapter →"])),b(n,l.id).catch(()=>{})),s.appendChild(e)}o.onkeydown=e=>{e.key==="ArrowLeft"&&g&&c.navigate(`/read/${n}/${g.id}`),e.key==="ArrowRight"&&l&&c.navigate(`/read/${n}/${l.id}`)};let u=0,y=0;o.ontouchstart=e=>{u=e.changedTouches[0].screenX,y=e.changedTouches[0].screenY},o.ontouchend=e=>{const a=e.changedTouches[0].screenX,d=e.changedTouches[0].screenY,r=a-u,x=d-y;u<40&&r>100&&Math.abs(x)<50&&c.navigate(`/manga/${n}`)},s.addEventListener("click",e=>{const a=e.target.closest("img");if(!a)return;const d=new Date().getTime(),r=d-(a.lastTap||0);r<300&&r>0&&(e.preventDefault(),a.style.transform==="scale(2)"?(a.style.transform="scale(1)",a.style.cursor="zoom-in",a.style.transformOrigin="center center"):(a.style.transform="scale(2)",a.style.cursor="zoom-out",a.style.transition="transform 0.3s ease")),a.lastTap=d}),setTimeout(()=>o.focus(),50)}catch(f){s.innerHTML="",s.appendChild(t("div",{className:"text-red-500 mt-20"},[f.message])),console.error(f)}return o}async function b(m,n){const i=await fetch(`http://localhost:3000/api/manga/${m}/chapters/${n}/pages`);if(!i.ok)throw new Error("Failed to load pages");return await i.json()}export{k as ReaderPage};
